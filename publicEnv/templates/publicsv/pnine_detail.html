{% extends 'father.html' %} {% load static %}{% block content %}
<div class="row">
	<div class="col-md-12">
		<div class="tile">
			<div class="alert alert-dismissible alert-success" role="alert">任务详情&nbsp;&nbsp;&nbsp;
				<a class="alert-link" href="/publicsv/svcheck/"><<返回列表</a>
			</div>
			<div class="tile-body">
				<div class="form-group row">
					<div class="col-md-12">
						<div id="container" style="width: 100%; height: 600px; margin: 0 auto"></div>
					</div>
				</div>				
			</div>
			<div class="alert alert-dismissible alert-success" role="alert">Summary&nbsp;&nbsp;&nbsp;</div>
			<div class="tile-body">
				<div class="form-group row">
					<div class="col-md-12">
						<table class="table">
		                    <thead>
		                    <tr>
		                        <td style="width: 50%;">Test summary</td>
		                        <td style="width: 50%;">Base summary</td>
		                    </tr>
		                    </thead>
		                    <tbody id="reqBody">
		                    <tr req_id="{{ task_detail.id }}" class="get_data">
		                        <td style="width: 50%;"><pre style="white-space: pre-wrap;word-wrap: break-word;">{{ testres_detail|safe }}</pre></td>
		                        <td style="width: 50%;"><pre style="white-space: pre-wrap;word-wrap: break-word;">{{ baseres_detail|safe }}</pre></td>
		                    </tr>
		                    </tbody>
		                </table>
					</div>
				</div>				
			</div>
			<div class="alert alert-dismissible alert-success" role="alert">LogInfo&nbsp;&nbsp;&nbsp;</div>
			<div class="tile-body">
				<div class="form-group row">
					<div class="col-md-12">
						<table class="table">
							<tr>
								<td>{{loginfo|safe}}</td>
							</tr>				
						</table>
					</div>
				</div>				
			</div>
		</div>
	</div>
</div>

{% endblock %} {% block js %}
<script src="{% static "js/highstock.js" %}"></script>
<script src="{% static "js/exporting.js" %}"></script>
<script language="JavaScript">
var seriesOptions = [],
	seriesCounter = 0,
	names = ['MSFT', 'AAPL', 'GOOG'],
	// create the chart when all data is loaded
	createChart = function () {
		Highcharts.stockChart('container', {
			rangeSelector: {
				selected: 4
			},
			yAxis: {
				labels: {
					formatter: function () {
						return (this.value > 0 ? ' + ' : '') + this.value + '%';
					}
				},
				plotLines: [{
					value: 0,
					width: 2,
					color: 'silver'
				}]
			},
			plotOptions: {
				series: {
					compare: 'percent'
				}
			},
			tooltip: {
				pointFormat: '<span style="color:{series.color}">{series.name}</span>: <b>{point.y}</b> ({point.change}%)<br/>',
				valueDecimals: 2
			},
			series: seriesOptions
		});
	};
$.each(names, function (i, name) {
//	$.getJSON('https://data.jianshukeji.com/jsonp?filename=json/' + name.toLowerCase() + '-c.json&callback=?',    function (data) {
//		seriesOptions[i] = {
//			name: name,
//			data: data
//		};
//		// As we're loading the data asynchronously, we don't know what order it will arrive. So
//		// we keep a counter and create the chart when all the data is loaded.
//		seriesCounter += 1;
//		if (seriesCounter === names.length) {
//			createChart();
//		}
//	});
	seriesOptions[i] = {
			name: name,
			data: ([
		{{task_detail.testres_list}}
])
		};
		// As we're loading the data asynchronously, we don't know what order it will arrive. So
		// we keep a counter and create the chart when all the data is loaded.
		seriesCounter += 1;
		if (seriesCounter === names.length) {
			createChart();
		}
});
</script>
<script>	
//table hover
	$(function() {
		function showBox(obj, box) {
			var timer = null;
			$(obj).on("mouseover", function(e) {
				clearTimeout(timer);
				var clientX = e.clientX;
				var clientY = e.clientY;
				var y = clientY + 20;
				var txt = $(this).text();
				timer = setTimeout(function() {
					$(box).css("left", clientX).css("top", y);
					if(txt == "") {
						$(box).hide();
					} else {
						$(box).show();
						$(box).html(txt);
					}
				}, 300);
			});
			$(obj).on("mouseout", function() {
				clearTimeout(timer);
				$(box).hide();
			});
		}
		showBox("#reqData > tbody td", "#showDiv");
	});
	
	
</script>
{% endblock %}
